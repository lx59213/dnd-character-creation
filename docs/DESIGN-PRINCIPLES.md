# D&D角色创建器 设计思维指南

## 核心理念

### 1. 结构即约束
不要依赖文档和记忆，而是让系统结构本身强制正确的实践。

```typescript
// 不好的方式：依赖文档说明
/* 
  请记住调用displayName而不是name
  请记住检查类型
  请记住验证数据
*/

// 好的方式：通过结构强制
type EntityId = `${EntityType}.${string}`;  // 类型系统强制ID格式
interface GameEntity {
  id: EntityId;        // 必需字段
  displayName: string; // 必需字段
}
```

### 2. 单一事实来源
每个概念在系统中只应有一种表达方式。

```typescript
// 不好的方式：多个表达
{
  name: "警觉",
  displayName: "警觉 (Alert)",
  englishName: "Alert"
}

// 好的方式：单一表达
{
  id: "feat.alert",
  displayName: "警觉 (Alert)"
}
```

### 3. 自动化优于规范
用工具和脚本强制执行规范，而不是靠人为遵守。

```bash
# 不好的方式：
请按照规范手动创建文件...

# 好的方式：
npm run create-entity feat alert  # 自动生成符合规范的文件
```

### 4. 错误前置
让错误在开发早期就能被发现，而不是运行时才暴露。

```typescript
// 不好的方式：运行时才发现
if (typeof feat.id !== 'string') {
  throw new Error('Invalid feat id');
}

// 好的方式：编译时就能发现
function addFeat(id: EntityId) {  // TypeScript会在编译时检查
  // ...
}
```

## 实践方法

1. **面对新需求时**：
   - 先思考如何通过系统结构防止错误
   - 而不是写更多的文档和规范

2. **设计新功能时**：
   - 优先考虑"如何让它难以用错"
   - 而不是"如何写好说明文档"

3. **遇到重复问题时**：
   - 创建自动化工具解决
   - 而不是增加检查步骤

4. **处理复杂逻辑时**：
   - 将规则编码进类型系统
   - 而不是依赖注释和文档

## 具体示例

### ID系统的实现思路
1. 通过TypeScript类型系统强制ID格式
2. 用目录结构反映数据关系
3. 创建工具自动化常见操作
4. 使用验证脚本确保一致性

### 新功能开发流程
1. 设计强制性的数据结构
2. 创建自动化工具
3. 建立编译时验证
4. 最后才写说明文档

## 记住

- 文档是对设计的补充，而不是主要依赖
- 好的设计是"难以用错"，而不是"说明详细"
- 自动化工具胜过完美规范
- 让系统结构本身成为最好的文档

## 检验标准

设计好的系统应该：
1. 在编译时就能发现大部分错误
2. 很难写出不符合规范的代码
3. 新人可以通过IDE提示就能正确使用
4. 不需要记住大量规则就能工作
